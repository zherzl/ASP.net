@{
    ViewBag.Title = "Print";
}
<div id="container">
    <h2>Print</h2>
    @using (Html.BeginForm("CreateCSV", "Main", FormMethod.Post))
    {
        <div id="left">
            <table>
                <tr>
                    <td>Datum od:
                    </td>
                    <td>
                        @Html.TextBox("datumOd", "", new { @type = "date", @id = "datumOd", @name = "datumOd" })
                    </td>
                </tr>
                <tr>
                    <td>Datum do:
                    </td>
                    <td>
                        @Html.TextBox("datumDo", "", new { @type = "date", @id = "datumDo", @name = "datumDo" })

                    </td>
                </tr>
                <tr>
                    <td>
                        <button type="submit">Ispisi CSV</button>
                        @*@Html.ActionLink("Print CSV", "CreateCSV")*@

                    </td>
                </tr>
            </table>
        </div>
    }
    <div id="right">
        <button id="btnIspisGraf">Ispisi graf</button>
        <div id="forGraph" style="display: none"></div>
    </div>
</div>
@section scripts
{
    <style>
        #left {
            float:left;
            width:50%;
        }
        #right {
            float:left;
            width:50%;
            
        }
    </style>

    <script type="text/javascript">

        // Load the Visualization API and the piechart package.
        google.load('visualization', '1.0', { 'packages': ['corechart'] });

        // Set a callback to run when the Google Visualization API is loaded.
        google.setOnLoadCallback(drawChart);

        // Callback that creates and populates a data table,
        // instantiates the pie chart, passes in the data and
        // draws it.

        $("#btnIspisGraf").on('click',
        function () {
            var datumOd = $("#datumOd").val();
            var datumDo = $("#datumDo").val();

            $.ajax({
                type: 'GET',
                url: '@Url.Action("GetDataForGraph", "Main")',
                data: { opt: "0" },
                dataType: "json",
                success: function (jsonData) {
                    var data = new google.visualization.DataTable();
                    data.addColumn('string', 'Kategorija');
                    data.addColumn('number', 'Iznos');

                    for (var i = 0; i < jsonData.length; i++) {
                        data.addRow([jsonData[i].Kategorija, jsonData[i].Iznos]);
                    }

                    var options = {
                        title: 'Kategorije i iznosi',
                        is3d: true
                    };

                    //var chart = new google.visualization.PieChart(document.getElementById('forGraph'));
                    var chart = new google.visualization.BarChart(document.getElementById('forGraph'));
                    chart.draw(data, options);
                    $("#forGraph").removeAttr('style');
                    //alert("Poslao sam");
                    //drawChart(data);
                },
                error: function (xhr, ajaxOpt, err) {
                    alert("Nisam uspio dohvatiti podatke");
                }

            });
        });


        function drawChart(list) {

            // Create the data table.
            var data = new google.visualization.DataTable();

            data.addColumn('string', 'Prihod');
            data.addColumn('number', 'Iznos prihoda');

            //data.addColumn('string', 'Trosak');
            //data.addColumn('number', 'Iznos troska');

            for (var i = 0; i < length; i++) {
                data.addRows(
                    [list[i].Kategorija, list[i].Iznos]);
            }

            //data.addRows([
            //  ['Gljive', 3],
            //  ['Onions', 1],
            //  ['Olives', 1],
            //  ['Zucchini', 1],
            //  ['Krokodili', 2]
            //]);

            // Set chart options
            var options = {
                'title': 'How Much Pizza I Ate Last Night',
                'width': 400,
                'height': 300
            };

            // Instantiate and draw our chart, passing in some options.
            var chart = new google.visualization.PieChart(document.getElementById('forGraph'));
            chart.draw(data, options);
        }


        //Napravi ajax get sa info
    </script>


}